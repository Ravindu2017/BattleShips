<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Ships</title>
    <style>
        #battleShips {
            /* background-color: black; */
            border: 2px solid;
            width: 500px;
            height: 400px;
        }

        #battleShipsTwo {
            /* background-color: black; */
            border: 2px solid;
            width: 500px;
            height: 400px;
        }

        #battleShips th, #battleShips td {
            background-color: white;
            border: 2px solid;
            padding: 20px;
        }

        #battleShipsTwo th, #battleShipsTwo td {
            background-color: white;
            border: 2px solid;
            padding: 20px;
        }

        /* #battleShips td:hover {
            background-color: gray;
            /* border: 2px solid;
            padding: 20px; *
        } */

        /* #battleShips td:hover {
            background-color: gray;
        } */
/* 
        #battleShipsTwo td:hover {
            background-color: gray;
            /*border: 2px solid;
             padding: 20px; /
        } */


    </style>
    <script src="gamePlan.js"></script>
</head>
<body>
    <table id="battleShips">
        <thead>
            <tr>
                <th></th>
                <th>A</th>
                <th>B</th>
                <th>C</th>
                <th>D</th>
                <th>E</th>
                <th>F</th>
                <th>G</th>
                <th>H</th>
                <th>I</th>
                <th>J</th>
            </tr>
        </thead>
        <tbody>
            <tr id="header-1">
                <th>1</th>
                <td>A1</td>
                <td>B1</td>
                <td>C1</td>
                <td>D1</td>
                <td>E1</td>
                <td>F1</td>
                <td>G1</td>
                <td>H1</td>
                <td>I1</td>
                <td>J1</td>
            </tr>
            <tr id="header-2">
                <th>2</th>
                <td>A2</td>
                <td>B2</td>
                <td>C2</td>
                <td>D2</td>
                <td>E2</td>
                <td>F2</td>
                <td>G2</td>
                <td>H2</td>
                <td>I2</td>
                <td>J2</td>
            </tr>
            <tr id="header-3">
                <th>3</th>
                <td>A3</td>
                <td>B3</td>
                <td>C3</td>
                <td>D3</td>
                <td>E3</td>
                <td>F3</td>
                <td>G3</td>
                <td>H3</td>
                <td>I3</td>
                <td>J3</td>
            </tr>
            <tr id="header-4">
                <th>4</th>
                <td>A4</td>
                <td>B4</td>
                <td>C4</td>
                <td>D4</td>
                <td>E4</td>
                <td>F4</td>
                <td>G4</td>
                <td>H4</td>
                <td>I4</td>
                <td>J4</td>
            </tr>
            <tr id="header-5">
                <th>5</th>
                <td>A5</td>
                <td>B5</td>
                <td>C5</td>
                <td>D5</td>
                <td>E5</td>
                <td>F5</td>
                <td>G5</td>
                <td>H5</td>
                <td>I5</td>
                <td>J5</td>
            </tr>
            <tr id="header-6">
                <th>6</th>
                <td>A6</td>
                <td>B6</td>
                <td>C6</td>
                <td>D6</td>
                <td>E6</td>
                <td>F6</td>
                <td>G6</td>
                <td>H6</td>
                <td>I6</td>
                <td>J6</td>
            </tr>
            <tr id="header-7">
                <th>7</th>
                <td>A7</td>
                <td>B7</td>
                <td>C7</td>
                <td>D7</td>
                <td>E7</td>
                <td>F7</td>
                <td>G7</td>
                <td>H7</td>
                <td>I7</td>
                <td>J7</td>
            </tr>
            <tr id="header-8">
                <th>8</th>
                <td>A8</td>
                <td>B8</td>
                <td>C8</td>
                <td>D8</td>
                <td>E8</td>
                <td>F8</td>
                <td>G8</td>
                <td>H8</td>
                <td>I8</td>
                <td>J8</td>
            </tr>
            <tr id="header-9">
                <th>9</th>
                <td>A9</td>
                <td>B9</td>
                <td>C9</td>
                <td>D9</td>
                <td>E9</td>
                <td>F9</td>
                <td>G9</td>
                <td>H9</td>
                <td>I9</td>
                <td>J9</td>
            </tr>
            <tr id="header-10">
                <th>10</th>
                <td>A10</td>
                <td>B10</td>
                <td>C10</td>
                <td>D10</td>
                <td>E10</td>
                <td>F10</td>
                <td>G10</td>
                <td>H10</td>
                <td>I10</td>
                <td>J10</td>
            </tr>
        </tbody>
    </table>
        <div><p></p></div>
    <table id="battleShipsTwo">
        <thead>
            <tr>
                <th></th>
                <th>A</th>
                <th>B</th>
                <th>C</th>
                <th>D</th>
                <th>E</th>
                <th>F</th>
                <th>G</th>
                <th>H</th>
                <th>I</th>
                <th>J</th>
            </tr>
        </thead>
        <tbody>
            <tr id="footer-1">
                <th>1</th>
                <td>A1</td>
                <td>B1</td>
                <td>C1</td>
                <td>D1</td>
                <td>E1</td>
                <td>F1</td>
                <td>G1</td>
                <td>H1</td>
                <td>I1</td>
                <td>J1</td>
            </tr>
            <tr id="footer-2">
                <th>2</th>
                <td>A2</td>
                <td>B2</td>
                <td>C2</td>
                <td>D2</td>
                <td>E2</td>
                <td>F2</td>
                <td>G2</td>
                <td>H2</td>
                <td>I2</td>
                <td>J2</td>
            </tr>
            <tr id="footer-3">
                <th>3</th>
                <td>A3</td>
                <td>B3</td>
                <td>C3</td>
                <td>D3</td>
                <td>E3</td>
                <td>F3</td>
                <td>G3</td>
                <td>H3</td>
                <td>I3</td>
                <td>J3</td>
            </tr>
            <tr id="footer-4">
                <th>4</th>
                <td>A4</td>
                <td>B4</td>
                <td>C4</td>
                <td>D4</td>
                <td>E4</td>
                <td>F4</td>
                <td>G4</td>
                <td>H4</td>
                <td>I4</td>
                <td>J4</td>
            </tr>
            <tr id="footer-5">
                <th>5</th>
                <td>A5</td>
                <td>B5</td>
                <td>C5</td>
                <td>D5</td>
                <td>E5</td>
                <td>F5</td>
                <td>G5</td>
                <td>H5</td>
                <td>I5</td>
                <td>J5</td>
            </tr>
            <tr id="footer-6">
                <th>6</th>
                <td>A6</td>
                <td>B6</td>
                <td>C6</td>
                <td>D6</td>
                <td>E6</td>
                <td>F6</td>
                <td>G6</td>
                <td>H6</td>
                <td>I6</td>
                <td>J6</td>
            </tr>
            <tr id="footer-7">
                <th>7</th>
                <td>A7</td>
                <td>B7</td>
                <td>C7</td>
                <td>D7</td>
                <td>E7</td>
                <td>F7</td>
                <td>G7</td>
                <td>H7</td>
                <td>I7</td>
                <td>J7</td>
            </tr>
            <tr id="footer-8">
                <th>8</th>
                <td>A8</td>
                <td>B8</td>
                <td>C8</td>
                <td>D8</td>
                <td>E8</td>
                <td>F8</td>
                <td>G8</td>
                <td>H8</td>
                <td>I8</td>
                <td>J8</td>
            </tr>
            <tr id="footer-9">
                <th>9</th>
                <td>A9</td>
                <td>B9</td>
                <td>C9</td>
                <td>D9</td>
                <td>E9</td>
                <td>F9</td>
                <td>G9</td>
                <td>H9</td>
                <td>I9</td>
                <td>J9</td>
            </tr>
            <tr id="footer-10">
                <th>10</th>
                <td>A10</td>
                <td>B10</td>
                <td>C10</td>
                <td>D10</td>
                <td>E10</td>
                <td>F10</td>
                <td>G10</td>
                <td>H10</td>
                <td>I10</td>
                <td>J10</td>
            </tr>
        </tbody>
    </table>

    <script>
    
        // document.getElementById("battleShips").addEventListener("click", myFunc);
        // document.getElementById("battleShipsTwo").addEventListener("click", myFunc);

        let turn = false;

        // class Position {
        //     constructor(width, depth){
        //         this.width = width;
        //         this.depth = depth;
        //         this.hit = null;
        //         this.ship = null;
        //     }
        // }

        // class Gameboard {
        //     // constructor() {
        //     //     this.board = board;
        //     // }
            
        //     append(x, y){
        //         const squares = new Position(x, y);
        //     }
        // }
        const playerOne = new Gameboard();
        const playerTwo = new Gameboard();

        playerOne.htmlID = "battleShips";
        playerTwo.htmlID = "battleShipsTwo";

        playerOne.createBoardGame();
        playerTwo.createBoardGame();

        playerOne.place();
        playerTwo.place();

        // placeShips(playerOne);
        // placeShips(playerTwo);

        // function placeShips(board){
        //     console.log(board, "board", board.shipsPlaced);
        //     // if (board.htmlID === "battleShips") {

        //     // } else if (board.htmlID = "battleShipsTwo") {

        //     // }
        //     let why = 2;
        //     while (board.shipsPlaced === false && why > 0) {
        //         board.place();
        //         board.updateShipsPlaced();

        //         for (const ship of Object.entries(board.ships)) {
        //             console.log(ship[0], ship[1], "inner loops");
        //             // place the ships
        //             // if ()
        //             delete board.ships[ship[0]]
        //         }
        //         if (board.board[e.target.innerText]) {
        //             console.log("we are in business");
        //         }
        //         why--;
        //     }
        // }


        function myFunc(e){
            // let turn = false;
            console.log(e.toElement, e);
            if (!(e.target.nodeName === "TD")) {
                return
            }

            if (!turn && e.target.parentElement.id.split("-")[0] === "header") { 
                turn = true;
            } else if (turn && e.target.parentElement.id.split("-")[0] === "footer") {
                turn = false;
            } else {
                console.log(turn, "..no?...");
                return;
            }

            // const location = new Position();
            const depth = e.target.parentElement.id.split("-");
            e.target.style.backgroundColor = "orange";
            console.log(e, e.target.color, depth[0]);
            let currentBoard = "";

            if (depth[0] === "header") {
                currentBoard = playerOne;
            } else if (depth[0] === "footer") {
                currentBoard = playerTwo;
            }

            console.log(currentBoard.board);

            currentBoard.board[e.target.innerText].hit = true;
            console.log(`Position ${e.target.innerText} has been hit!`);
            // return location
        }

        document.getElementById("battleShips").addEventListener("click", myFunc);
        document.getElementById("battleShipsTwo").addEventListener("click", myFunc);

        document.getElementById("battleShipsTwo").addEventListener("mouseover", mouseGray
            // (e) => {
            //     if (e.toElement.nodeName === "TD") {
            //         // console.log(e, e.toElement.nodeName, e.target.innerText, e.target.parentElement);
            //         // console.log("GARY");
            //         if (playerTwo.board[e.target.innerText].hit !== true) {
            //             // console.log(e, e.toElement.nodeName, e.target.innerText, e.target.parentElement.id);
            //             console.log("GARY", playerTwo.board[e.target.innerText].hit);
            //             // console.log(e.target.parentElement.id.split("-")[0]);
            //             e.target.style.backgroundColor = "grey";
            //         }
            //     }
            // }
        );

        document.getElementById("battleShipsTwo").addEventListener("mouseout", mouseWhite
            // (e) => {
            //     if (e.fromElement.nodeName === "TD") {
            //         // console.log(playerOne.board[e.target.innerText], e.target.innerText);
            //         // console.log(e.target.parentElement.id.split("-")[0]);
            //         if (playerTwo.board[e.target.innerText].hit !== true) {
            //             console.log("GARY white", playerTwo.board[e.target.innerText].hit, e.target.innerText, playerTwo.board[e.target.innerText]);
            //             e.target.style.backgroundColor = "white";
            //         }
            //     }
            // }
        );


        // Let's execute these functions only after the ships have been placed
        document.getElementById("battleShips").addEventListener("mouseover", mouseGray);
        document.getElementById("battleShips").addEventListener("mouseout", mouseWhite);

        // let shipsPlzaced = false;

        function mouseGray(e) {
            // console.log(e, "mouseGray called");
            
            let arena = "";
            let parentNode = "";
            // console.log(e.target.toElement);

            if (e.toElement.nodeName === "TD") {
                if (e.target.parentElement.id.split("-")[0] === "header") {
                    arena = playerOne;
                    parentNode = document.getElementById("battleShips");
                } else if (e.target.parentElement.id.split("-")[0] === "footer") {
                    arena = playerTwo;
                    parentNode = document.getElementById("battleShipsTwo");
                }

                //  this should later be replaced by checking object property
                //  such as arena.shipsPlaced
                console.log(arena.shipsPlaced, "DONE")
                // If ships are done being put in the board then continue to
                // turn the boards gray
                if (arena.shipsPlaced) {
                    console.log("return");
                    if (arena.board[e.target.innerText].hit !== true) {
                        e.target.style.backgroundColor = "gray";
                    }
                    return
                } else if (arena.shipsPlaced === false) {
                    e.target.style.backgroundColor = "red";
                    rotateShips(arena, parentNode, e.target.innerText, e);
                }

                // if (e.toElement.nodeName === "TD") {
                    // if (arena.board[e.target.innerText].hit !== true) {
                    //     e.target.style.backgroundColor = "gray";
                    // }
                // }
            }
        }

        // function mouseGray(e) {
        //     // console.log(e, "mouseGray called");
            
        //     let arena = "";
        //     let parentNode = "";
        //     // console.log(e.target.toElement);

        //     if (e.target.parentElement.id.split("-")[0] === "header") {
        //         arena = playerOne;
        //         parentNode = document.getElementById("battleShips");
        //     } else if (e.target.parentElement.id.split("-")[0] === "footer") {
        //         arena = playerTwo;
        //         parentNode = document.getElementById("battleShipsTwo");
        //     }


        //     // this should later be replaced by checking object property
        //     // such as arena.shipsPlaced
        //     let areShipsDone = rotateShips(arena, parentNode, e.target.innerText, e);
        //     // console.log(areShipsDone, "DONE")
        //     if (!areShipsDone) {
        //         console.log("return");
        //         return
        //     }

        //     if (e.toElement.nodeName === "TD") {
        //         // console.log(e, e.toElement.nodeName, e.target.innerText, e.target.parentElement);
        //         // console.log("GARY");
        //         // if (e.target.parentElement.id.split("-")[0] === "header") {
        //         //     arena = playerOne;
        //         //     parentNode = document.getElementById("battleShips");
        //         // } else if (e.target.parentElement.id.split("-")[0] === "footer") {
        //         //     arena = playerTwo;
        //         //     parentNode = document.getElementById("battleShipsTwo");
        //         // }

        //         // let areShipsDone = rotateShips(arena, parentNode, e.target.innerText);

        //         // if (areShipsDone) {
        //         //     console.log("return");
        //         //     return
        //         // }

        //         // rotateShips(arena, parentNode, e.target.innerText);
        //         // if (rotateShips(arena, parentNode, e.target.innerText) === false) {
        //         //     return
        //         // }

        //         // let areShipsDone = rotateShips(arena, parentNode, e.target.innerText);
        //         // console.log("done", areShipsDone);
        //         // if (rotateShips(arena, parentNode, shipsPlaced, e.target.innerText) === false) {
        //         // if (areShipsDone) {
        //         //     console.log("return");
        //         //     return
        //         // }

        //         if (arena.board[e.target.innerText].hit !== true) {
                    
        //             // console.log(e, e.toElement.nodeName, e.target.innerText, e.target.parentElement.id);
        //             // console.log("Mouse Gray", playerTwo.board[e.target.innerText].hit);
        //             // console.log(e.target.parentElement.id.split("-")[0], e.target.innerText[0], e, nodeList[3].children, nodeList[3].rows);
                    
        //             // document.getElementByTagName()
        //             // for (const tag of document.querySelectorAll("td")) {
        //             //     if (tag.textContent.includes(`${e.target.innerText[0]}`)){
        //             //         console.log(tag.textContent, "inner loops");
        //             //         tag.style.backgroundColor = "gray";
        //             //     }
        //             // }
        //             e.target.style.backgroundColor = "gray";
        //         }
        //     }
        // }

        function mouseWhite(e) {
            // console.log(e, "mouseWhite called");
            let arena = "";
            if (e.fromElement.nodeName === "TD") {
                // console.log(playerOne.board[e.target.innerText], e.target.innerText);
                // console.log(e.target.parentElement.id.split("-")[0]);
                if (e.target.parentElement.id.split("-")[0] === "header") {
                    arena = playerOne;
                } else if (e.target.parentElement.id.split("-")[0] === "footer") {
                    arena = playerTwo;
                }
                if (arena.board[e.target.innerText].hit !== true) {
                    // console.log("Mouse White", playerTwo.board[e.target.innerText].hit, e.target.innerText, playerTwo.board[e.target.innerText]);
                    e.target.style.backgroundColor = "white";
                }
            }
        }

        document.addEventListener("keydown", (e) => {
                                console.log("WHAAA");
                                playerBoard.board[loc[0]+(idx)].ship = true;
                                delete playerBoard.ships[Object.keys(playerBoard.ships)[0]];
                                why = true;
                            });

        function rotateShips(playerBoard, htmlBoard, loc, e) {
            // console.log(playerBoard.board, htmlBoard.childNodes[3].childNodes[1].childNodes);
            // playerBoard.place();

            let boardNodes = {

            };

            let why = false;
            let stop = 20;
            // while (playerBoard.shipsPlaced === false && why > 0) {
            // While player is hovering over the game board
            while (playerBoard.shipsPlaced === false && why === false && stop > 0) {
                playerBoard.updateShipsPlaced();
                // console.log(playerBoard.shipsPlaced, "inner");

                // Iterate through gameboard's ships
                for (const ship of Object.entries(playerBoard.ships)) {
                    // console.log(ship[0], ship[1], "inner loops");
                    // place the ships
                    // if ()
                    let shipLength = ship[1];

                    // Iterate through each ship's length
                    for (let j = 0; j < shipLength; j++) {
                        //playerBoardHorizontal
                        let idx = Number(loc[1]) + j;
                        if (idx <= 10 && !playerBoard.board[loc[0]+(idx)].ship) {
                            // if (idx <= 10) {
                            // console.log("jcole", playerBoard.board[loc[0]+(loc[1]+j)], loc[0]+(loc[1]+j));
                            playerBoard.board[loc[0]+(idx)].ship = true;
                            // console.log(ship[0], "jcole", playerBoard.board[loc[0]+(idx)], loc[0]+(idx), htmlBoard);

                            // e.target.style.backgroundColor = "red";
                            //
                            //playerboardVertical
                            // delete playerBoard.ships[ship[0]];
                        }
                    }
                }

                // if (playerBoard.board[loc]) {
                //     console.log("we are in business");
                // }

                // why--;
                stop--;
            }

            delete playerBoard.ships[Object.keys(playerBoard.ships)[0]];
            playerBoard.updateShipsPlaced();
            console.log("SHIP? ", Object.keys(playerBoard.ships)[0], playerOne.ships, Object.getOwnPropertyDescriptor(playerOne.ships, "Patrol"), Object.getOwnPropertyDescriptor(playerBoard.ships, "Patrol"));



            return playerBoard.shipsPlaced
            // for (const ship of Object.entries(playerBoard.ships)) {
            //     console.log(ship[0], ship[1], "inner loops");
            // }

            // This code goes through both boards, need to narrow it down to just one board
            // for (const tag of document.querySelectorAll("td")) {
            // for (const tag of htmlBoard.childNodes[3].childNodes[3].childNodes) {
            //     if (tag.textContent.includes(`${loc[0]}`)){
            //         console.log(tag.textContent, "inner loops");
            //         tag.style.backgroundColor = "gray";
            //     }
            // }

            // if (placed === false) {
            //     document.getElementById("battleShipsTwo");
            //     // const nodeList = parentNode.childNodes;
            //     // let row = e.target.innerText[1] - 1;
            //     // console.log("Rows", e.target.innerText[1], nodeList[3].rows[row], nodeList[3].rows[9].cells[10]);
            //     // for (const tag of document.querySelectorAll("td")) {
            //     //     if (tag.textContent.includes(`${e.target.innerText[0]}`)){
            //     //         console.log(tag.textContent, "inner loops");
            //     //         tag.style.backgroundColor = "gray";
            //     //     }
            //     // }
            //     placed = true;
            // }
            // return placed
        }

        // rotateShips(playerOne, false);

        // module.exports = {
        //     Position
        // }
    </script>
</body>
</html>